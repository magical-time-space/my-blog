<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.61" />
    <meta name="theme" content="VuePress Theme Hope" />
    <meta property="og:url" content="https://mpbug.gitee.io/views/Books/Front-end/JustVue2/reactive/computed-watcher.html"><meta property="og:site_name" content="魔法Bug"><meta property="og:title" content="计算属性 VS 侦听属性"><meta property="og:description" content="计算属性 VS 侦听属性 Vue 的组件对象支持了计算属性 computed 和侦听属性 watch 2 个选项，很多同学不了解什么时候该用 computed 什么时候该用 watch。先不回答这个问题，我们接下来从源码实现的角度来分析它们两者有什么区别。 computed 计算属性的初始化是发生在 Vue 实例初始化阶段的 initState 函数中，执行了 if (opts.computed) initComputed(vm, opts.computed)，initComputed 的定义在 src/core/instance/state.js 中："><meta property="og:type" content="article"><meta property="og:locale" content="zh-CN"><meta property="article:author" content="魔法时空宝库"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"计算属性 VS 侦听属性","image":[""],"dateModified":null,"author":[{"@type":"Person","name":"魔法时空宝库","url":"https://mpbug.gitee.io/player/"}]}</script><title>计算属性 VS 侦听属性 | 魔法Bug</title><meta name="description" content="计算属性 VS 侦听属性 Vue 的组件对象支持了计算属性 computed 和侦听属性 watch 2 个选项，很多同学不了解什么时候该用 computed 什么时候该用 watch。先不回答这个问题，我们接下来从源码实现的角度来分析它们两者有什么区别。 computed 计算属性的初始化是发生在 Vue 实例初始化阶段的 initState 函数中，执行了 if (opts.computed) initComputed(vm, opts.computed)，initComputed 的定义在 src/core/instance/state.js 中：">
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d1e1f;
      }

      html,
      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="preload" href="/assets/style-345afa22.css" as="style"><link rel="stylesheet" href="/assets/style-345afa22.css">
    <link rel="modulepreload" href="/assets/app-36439b21.js"><link rel="modulepreload" href="/assets/framework-d8252107.js"><link rel="modulepreload" href="/assets/computed-watcher.html-8e8377e0.js"><link rel="modulepreload" href="/assets/computed-watcher.html-43eed0d1.js"><link rel="prefetch" href="/assets/index.html-addc0ce4.js" as="script"><link rel="prefetch" href="/assets/intro.html-86d922dd.js" as="script"><link rel="prefetch" href="/assets/slides.html-7db34244.js" as="script"><link rel="prefetch" href="/assets/slidesOld.html-2f396fe5.js" as="script"><link rel="prefetch" href="/assets/index.html-872a68ad.js" as="script"><link rel="prefetch" href="/assets/mg.html-c0025bc1.js" as="script"><link rel="prefetch" href="/assets/mg.html-b3d5c19f.js" as="script"><link rel="prefetch" href="/assets/index.html-70a81eac.js" as="script"><link rel="prefetch" href="/assets/中华田园文化.html-851a46e4.js" as="script"><link rel="prefetch" href="/assets/NormalDay.html-97f6245e.js" as="script"><link rel="prefetch" href="/assets/index.html-c92940b6.js" as="script"><link rel="prefetch" href="/assets/争与不争.html-53c904c0.js" as="script"><link rel="prefetch" href="/assets/和气生财.html-6f61e47c.js" as="script"><link rel="prefetch" href="/assets/闷声发大财.html-38c1f0c2.js" as="script"><link rel="prefetch" href="/assets/index.html-1d8c7134.js" as="script"><link rel="prefetch" href="/assets/github.html-4ad21375.js" as="script"><link rel="prefetch" href="/assets/高速摄像头资源.html-6f3a8865.js" as="script"><link rel="prefetch" href="/assets/浏览器收藏夹-脚本.html-d8bd7369.js" as="script"><link rel="prefetch" href="/assets/course.html-c1d46c99.js" as="script"><link rel="prefetch" href="/assets/index.html-68f040f1.js" as="script"><link rel="prefetch" href="/assets/me.html-7d031bfa.js" as="script"><link rel="prefetch" href="/assets/index.html-41851142.js" as="script"><link rel="prefetch" href="/assets/index.html-bbbccc6d.js" as="script"><link rel="prefetch" href="/assets/基础知识：配色原理.html-40d335fe.js" as="script"><link rel="prefetch" href="/assets/背景知识：色学发展时间表.html-43f7121d.js" as="script"><link rel="prefetch" href="/assets/课程知识：颜色科学.html-9209370a.js" as="script"><link rel="prefetch" href="/assets/Setting.html-6c87dd6b.js" as="script"><link rel="prefetch" href="/assets/Snippets.html-9b428701.js" as="script"><link rel="prefetch" href="/assets/程序员常用英语词汇.html-1d3c642f.js" as="script"><link rel="prefetch" href="/assets/计算机编程及常用术语英语词汇大全.html-16007e53.js" as="script"><link rel="prefetch" href="/assets/1114路由器默认密码.html-c6861754.js" as="script"><link rel="prefetch" href="/assets/dism安装脚本.html-ba9c8eac.js" as="script"><link rel="prefetch" href="/assets/ChromeExtension.html-4c313a0a.js" as="script"><link rel="prefetch" href="/assets/Git with SSH.html-de681400.js" as="script"><link rel="prefetch" href="/assets/AI工具.html-56133034.js" as="script"><link rel="prefetch" href="/assets/时空葫芦工具箱.html-8ebb991e.js" as="script"><link rel="prefetch" href="/assets/音乐番茄果果果.html-ada18b1b.js" as="script"><link rel="prefetch" href="/assets/《周公解梦》.html-3d0c3038.js" as="script"><link rel="prefetch" href="/assets/《敦煌本梦书》.html-4a7d3c98.js" as="script"><link rel="prefetch" href="/assets/《断梦秘书》.html-eeaf23fb.js" as="script"><link rel="prefetch" href="/assets/《入药镜》.html-3d6b0ce3.js" as="script"><link rel="prefetch" href="/assets/index.html-a71af805.js" as="script"><link rel="prefetch" href="/assets/一般广告违禁词.html-fcdec837.js" as="script"><link rel="prefetch" href="/assets/中华人民共和国广告法.html-2de68e4a.js" as="script"><link rel="prefetch" href="/assets/互联网广告管理办法.html-ee9737f2.js" as="script"><link rel="prefetch" href="/assets/index.html-c2cf9b1a.js" as="script"><link rel="prefetch" href="/assets/中华人民共和国著作权法（2020）.html-69cfbbb0.js" as="script"><link rel="prefetch" href="/assets/中国版权保护中心著作权自愿登记收费标准.html-90de4638.js" as="script"><link rel="prefetch" href="/assets/index.html-eeb4af03.js" as="script"><link rel="prefetch" href="/assets/disrupt.html-d7247a4d.js" as="script"><link rel="prefetch" href="/assets/lane.html-cede7741.js" as="script"><link rel="prefetch" href="/assets/prepare.html-3546f72b.js" as="script"><link rel="prefetch" href="/assets/scheduler.html-adbd7c59.js" as="script"><link rel="prefetch" href="/assets/multi.html-2e47714e.js" as="script"><link rel="prefetch" href="/assets/one.html-866a3d7b.js" as="script"><link rel="prefetch" href="/assets/prepare.html-c062468f.js" as="script"><link rel="prefetch" href="/assets/create.html-9603f579.js" as="script"><link rel="prefetch" href="/assets/prepare.html-a14a2769.js" as="script"><link rel="prefetch" href="/assets/structure.html-5811dc49.js" as="script"><link rel="prefetch" href="/assets/useeffect.html-fbeb16cf.js" as="script"><link rel="prefetch" href="/assets/usememo.html-b668d622.js" as="script"><link rel="prefetch" href="/assets/useref.html-e532600b.js" as="script"><link rel="prefetch" href="/assets/usestate.html-43316131.js" as="script"><link rel="prefetch" href="/assets/file.html-5ba73d91.js" as="script"><link rel="prefetch" href="/assets/idea.html-5ac4f97d.js" as="script"><link rel="prefetch" href="/assets/jsx.html-3d928293.js" as="script"><link rel="prefetch" href="/assets/newConstructure.html-cceabde0.js" as="script"><link rel="prefetch" href="/assets/oldConstructure.html-6fa3115f.js" as="script"><link rel="prefetch" href="/assets/source.html-c019a563.js" as="script"><link rel="prefetch" href="/assets/summary.html-0a6c8100.js" as="script"><link rel="prefetch" href="/assets/beginWork.html-45bc5f39.js" as="script"><link rel="prefetch" href="/assets/completeWork.html-91fecc21.js" as="script"><link rel="prefetch" href="/assets/doubleBuffer.html-b0935f8f.js" as="script"><link rel="prefetch" href="/assets/fiber-mental.html-1bc7e55a.js" as="script"><link rel="prefetch" href="/assets/fiber.html-45d5764f.js" as="script"><link rel="prefetch" href="/assets/reconciler.html-b2924ace.js" as="script"><link rel="prefetch" href="/assets/mental.html-a4853a34.js" as="script"><link rel="prefetch" href="/assets/prepare.html-95fa0e6c.js" as="script"><link rel="prefetch" href="/assets/priority.html-bb8f6ee0.js" as="script"><link rel="prefetch" href="/assets/reactdom.html-73a96dc8.js" as="script"><link rel="prefetch" href="/assets/setstate.html-eb0b7436.js" as="script"><link rel="prefetch" href="/assets/update.html-1f2f08e3.js" as="script"><link rel="prefetch" href="/assets/beforeMutation.html-16341311.js" as="script"><link rel="prefetch" href="/assets/layout.html-04309b44.js" as="script"><link rel="prefetch" href="/assets/mutation.html-5dabbbb5.js" as="script"><link rel="prefetch" href="/assets/prepare.html-3211d06c.js" as="script"><link rel="prefetch" href="/assets/codegen.html-15e2ddec.js" as="script"><link rel="prefetch" href="/assets/entrance.html-83fee51d.js" as="script"><link rel="prefetch" href="/assets/index.html-d7856c62.js" as="script"><link rel="prefetch" href="/assets/optimize.html-de2eb9b5.js" as="script"><link rel="prefetch" href="/assets/parse.html-6acdbb35.js" as="script"><link rel="prefetch" href="/assets/async-component.html-69322b5c.js" as="script"><link rel="prefetch" href="/assets/component-register.html-ed46fd4a.js" as="script"><link rel="prefetch" href="/assets/create-component.html-f5559572.js" as="script"><link rel="prefetch" href="/assets/index.html-7b897ecc.js" as="script"><link rel="prefetch" href="/assets/lifecycle.html-2cf05d1b.js" as="script"><link rel="prefetch" href="/assets/merge-option.html-94ea7cc9.js" as="script"><link rel="prefetch" href="/assets/patch.html-4574b1c4.js" as="script"><link rel="prefetch" href="/assets/create-element.html-bd5a9968.js" as="script"><link rel="prefetch" href="/assets/index.html-ecf57dc4.js" as="script"><link rel="prefetch" href="/assets/mounted.html-c376f823.js" as="script"><link rel="prefetch" href="/assets/new-vue.html-176dd059.js" as="script"><link rel="prefetch" href="/assets/render.html-2450be2c.js" as="script"><link rel="prefetch" href="/assets/update.html-bf28ba9f.js" as="script"><link rel="prefetch" href="/assets/virtual-dom.html-3447b9e3.js" as="script"><link rel="prefetch" href="/assets/event.html-ccd24b90.js" as="script"><link rel="prefetch" href="/assets/index.html-61eb365b.js" as="script"><link rel="prefetch" href="/assets/keep-alive.html-9f4ec5d4.js" as="script"><link rel="prefetch" href="/assets/slot.html-a0e481b9.js" as="script"><link rel="prefetch" href="/assets/tansition-group.html-e27c4660.js" as="script"><link rel="prefetch" href="/assets/tansition.html-51c5a387.js" as="script"><link rel="prefetch" href="/assets/v-model.html-b24e8e34.js" as="script"><link rel="prefetch" href="/assets/build.html-3c50fd31.js" as="script"><link rel="prefetch" href="/assets/directory.html-67f49f0e.js" as="script"><link rel="prefetch" href="/assets/entrance.html-be82b143.js" as="script"><link rel="prefetch" href="/assets/flow.html-b089c19c.js" as="script"><link rel="prefetch" href="/assets/index.html-482f121e.js" as="script"><link rel="prefetch" href="/assets/component-update.html-d00a8089.js" as="script"><link rel="prefetch" href="/assets/getters.html-95a35379.js" as="script"><link rel="prefetch" href="/assets/index.html-1184c68a.js" as="script"><link rel="prefetch" href="/assets/next-tick.html-4e0ed553.js" as="script"><link rel="prefetch" href="/assets/props.html-7bc69771.js" as="script"><link rel="prefetch" href="/assets/questions.html-bd6d9094.js" as="script"><link rel="prefetch" href="/assets/reactive-object.html-97ed8726.js" as="script"><link rel="prefetch" href="/assets/setters.html-c5d76f6b.js" as="script"><link rel="prefetch" href="/assets/summary.html-62653e09.js" as="script"><link rel="prefetch" href="/assets/index.html-410922b4.js" as="script"><link rel="prefetch" href="/assets/install.html-4e71ca65.js" as="script"><link rel="prefetch" href="/assets/matcher.html-7b380ac8.js" as="script"><link rel="prefetch" href="/assets/router.html-94efd1ad.js" as="script"><link rel="prefetch" href="/assets/transition-to.html-cb838d9a.js" as="script"><link rel="prefetch" href="/assets/api.html-bd6166a0.js" as="script"><link rel="prefetch" href="/assets/index.html-f6e88c60.js" as="script"><link rel="prefetch" href="/assets/init.html-7454a41e.js" as="script"><link rel="prefetch" href="/assets/plugin.html-f7f4e411.js" as="script"><link rel="prefetch" href="/assets/ast.html-378b379f.js" as="script"><link rel="prefetch" href="/assets/binder.html-5802fab7.js" as="script"><link rel="prefetch" href="/assets/checker.html-0664c439.js" as="script"><link rel="prefetch" href="/assets/emitter.html-b42b0689.js" as="script"><link rel="prefetch" href="/assets/overview.html-2b6f5ec3.js" as="script"><link rel="prefetch" href="/assets/parser.html-45b8186f.js" as="script"><link rel="prefetch" href="/assets/program.html-9d19302c.js" as="script"><link rel="prefetch" href="/assets/scanner.html-192076ab.js" as="script"><link rel="prefetch" href="/assets/common.html-a8627d3a.js" as="script"><link rel="prefetch" href="/assets/interpreting.html-d828600b.js" as="script"><link rel="prefetch" href="/assets/class.html-e99c3769.js" as="script"><link rel="prefetch" href="/assets/commandline-behavior.html-9ea13d60.js" as="script"><link rel="prefetch" href="/assets/comments.html-e64f20fd.js" as="script"><link rel="prefetch" href="/assets/common-bug-not-bugs.html-caa8a65f.js" as="script"><link rel="prefetch" href="/assets/common-feature-request.html-f7dc98df.js" as="script"><link rel="prefetch" href="/assets/decorators.html-8fb9baed.js" as="script"><link rel="prefetch" href="/assets/enums.html-af9ad7cd.js" as="script"><link rel="prefetch" href="/assets/function.html-2d62c8e4.js" as="script"><link rel="prefetch" href="/assets/generics.html-cc0b0e0a.js" as="script"><link rel="prefetch" href="/assets/glossary-and-terms.html-f6a931bf.js" as="script"><link rel="prefetch" href="/assets/jsx-and-react.html-89bb9d8a.js" as="script"><link rel="prefetch" href="/assets/modules.html-5c1cf89e.js" as="script"><link rel="prefetch" href="/assets/thing-that-dont-work.html-37ea0cba.js" as="script"><link rel="prefetch" href="/assets/tsconfig-behavior.html-525b9c3e.js" as="script"><link rel="prefetch" href="/assets/type-guards.html-a6ed0548.js" as="script"><link rel="prefetch" href="/assets/type-system-behavior.html-97755d6f.js" as="script"><link rel="prefetch" href="/assets/nonReactJSX.html-cfefe2a5.js" as="script"><link rel="prefetch" href="/assets/reactJSX.html-1cfd37f7.js" as="script"><link rel="prefetch" href="/assets/support.html-c282d4fb.js" as="script"><link rel="prefetch" href="/assets/typescript-3.7.html-316db639.js" as="script"><link rel="prefetch" href="/assets/typescript-3.8.html-2b46055c.js" as="script"><link rel="prefetch" href="/assets/typescript-3.9.html-bec3bc12.js" as="script"><link rel="prefetch" href="/assets/compilationContext.html-dc1ef112.js" as="script"><link rel="prefetch" href="/assets/declarationspaces.html-afe66779.js" as="script"><link rel="prefetch" href="/assets/dynamicImportExpressions.html-c09ef21a.js" as="script"><link rel="prefetch" href="/assets/modules.html-f5fc9af5.js" as="script"><link rel="prefetch" href="/assets/namespaces.html-65ad7872.js" as="script"><link rel="prefetch" href="/assets/avoidExportDefault.html-159c85c1.js" as="script"><link rel="prefetch" href="/assets/barrel.html-2f7c72f6.js" as="script"><link rel="prefetch" href="/assets/bind.html-10be9ab1.js" as="script"><link rel="prefetch" href="/assets/buildToggles.html-43c46f2c.js" as="script"><link rel="prefetch" href="/assets/classAreUseful.html-858036fb.js" as="script"><link rel="prefetch" href="/assets/covarianceAndContravariance.html-b2049264.js" as="script"><link rel="prefetch" href="/assets/createArrays.html-f59314a1.js" as="script"><link rel="prefetch" href="/assets/curry.html-e4e6c844.js" as="script"><link rel="prefetch" href="/assets/functionParameters.html-4d3578a3.js" as="script"><link rel="prefetch" href="/assets/infer.html-4dc5d9dc.js" as="script"><link rel="prefetch" href="/assets/lazyObjectLiteralInitialization.html-9c16444a.js" as="script"><link rel="prefetch" href="/assets/limitPropertySetters.html-94133da7.js" as="script"><link rel="prefetch" href="/assets/metadata.html-3e371450.js" as="script"><link rel="prefetch" href="/assets/nominalTyping.html-dca5c8e5.js" as="script"><link rel="prefetch" href="/assets/outFileCaution.html-571cccaa.js" as="script"><link rel="prefetch" href="/assets/singletonPatern.html-6b137eec.js" as="script"><link rel="prefetch" href="/assets/statefulFunctions.html-ef94f425.js" as="script"><link rel="prefetch" href="/assets/staticConstructors.html-5e683034.js" as="script"><link rel="prefetch" href="/assets/stringBasedEmuns.html-c0557a31.js" as="script"><link rel="prefetch" href="/assets/truthy.html-6f0ff5e4.js" as="script"><link rel="prefetch" href="/assets/typeInstantiation.html-9f6bfd31.js" as="script"><link rel="prefetch" href="/assets/typesafeEventEmitter.html-ea81348a.js" as="script"><link rel="prefetch" href="/assets/ambient.html-bff6b50b.js" as="script"><link rel="prefetch" href="/assets/callable.html-e8ee0ea6.js" as="script"><link rel="prefetch" href="/assets/discrominatedUnion.html-2b43e7e7.js" as="script"><link rel="prefetch" href="/assets/enums.html-51aa068f.js" as="script"><link rel="prefetch" href="/assets/exceptionsHanding.html-21483fcb.js" as="script"><link rel="prefetch" href="/assets/freshness.html-dee51d40.js" as="script"><link rel="prefetch" href="/assets/functions.html-62641f59.js" as="script"><link rel="prefetch" href="/assets/generices.html-4d2ac27d.js" as="script"><link rel="prefetch" href="/assets/indexSignatures.html-43769f30.js" as="script"><link rel="prefetch" href="/assets/interfaces.html-10ff7e3b.js" as="script"><link rel="prefetch" href="/assets/lib.html-f244b2ca.js" as="script"><link rel="prefetch" href="/assets/literals.html-77a87e33.js" as="script"><link rel="prefetch" href="/assets/migrating.html-5f17a57d.js" as="script"><link rel="prefetch" href="/assets/mixins.html-2156d664.js" as="script"><link rel="prefetch" href="/assets/movingTypes.html-6777fb84.js" as="script"><link rel="prefetch" href="/assets/neverType.html-faf1f818.js" as="script"><link rel="prefetch" href="/assets/overview.html-4a5559c1.js" as="script"><link rel="prefetch" href="/assets/readonly.html-e1b8e5c9.js" as="script"><link rel="prefetch" href="/assets/thisType.html-9e8d8300.js" as="script"><link rel="prefetch" href="/assets/typeAssertion.html-098fc501.js" as="script"><link rel="prefetch" href="/assets/typeCompatibility.html-193f6c5d.js" as="script"><link rel="prefetch" href="/assets/typeGuard.html-0d21e5c7.js" as="script"><link rel="prefetch" href="/assets/typeInference.html-91ca5bf5.js" as="script"><link rel="prefetch" href="/assets/types.html-b38601de.js" as="script"><link rel="prefetch" href="/assets/CIE 1931 XYZ色彩空间详解.html-b79ea964.js" as="script"><link rel="prefetch" href="/assets/CIE 色度出版物（中英文）2018.html-268c6dc4.js" as="script"><link rel="prefetch" href="/assets/CIE.1931.COLOUR-MATCHING.FUNCTIONS.2.DEGREE.OBSERVE.html-f008f3de.js" as="script"><link rel="prefetch" href="/assets/CIE170-1(CIE2006a)颜色匹配函数计算模型.html-759c7276.js" as="script"><link rel="prefetch" href="/assets/根据功率频谱准确绘制 LED 颜色 - 文章资源.html-43572021.js" as="script"><link rel="prefetch" href="/assets/工具：函数图像工具.html-fc8045f6.js" as="script"><link rel="prefetch" href="/assets/案例大全.html-07b0a2a6.js" as="script"><link rel="prefetch" href="/assets/图标：vuepress-temp-hope.html-5e521365.js" as="script"><link rel="prefetch" href="/assets/课程介绍.html-65607166.js" as="script"><link rel="prefetch" href="/assets/html-css.html-d667f76a.js" as="script"><link rel="prefetch" href="/assets/javascript.html-6c536b3e.js" as="script"><link rel="prefetch" href="/assets/password.html-b5a70493.js" as="script"><link rel="prefetch" href="/assets/Base64.html-80d4029b.js" as="script"><link rel="prefetch" href="/assets/Color.html-9cb5306b.js" as="script"><link rel="prefetch" href="/assets/UUID.html-7727e2cf.js" as="script"><link rel="prefetch" href="/assets/audioAnalyser.html-7ae86e26.js" as="script"><link rel="prefetch" href="/assets/deep.clone.html-73bd5813.js" as="script"><link rel="prefetch" href="/assets/download.html-118f0090.js" as="script"><link rel="prefetch" href="/assets/format.html-bce01f07.js" as="script"><link rel="prefetch" href="/assets/iframe.html-e5f8b8c9.js" as="script"><link rel="prefetch" href="/assets/loadjs.html-be37afc9.js" as="script"><link rel="prefetch" href="/assets/parseToJson.html-06ab6bb4.js" as="script"><link rel="prefetch" href="/assets/getComputedStyle.html-1205c1d8.js" as="script"><link rel="prefetch" href="/assets/localeCompare.html-8552ed16.js" as="script"><link rel="prefetch" href="/assets/图像：2° coordinates from 2°  XYZ CMFs.html-6c3f97f0.js" as="script"><link rel="prefetch" href="/assets/图像：2°.CIE.1931.RGB系统光谱三刺激值曲线.html-72df77aa.js" as="script"><link rel="prefetch" href="/assets/图像：2°.CIE.1931.XYZ系统光谱三刺激值曲线.html-8eaa0a92.js" as="script"><link rel="prefetch" href="/assets/数据：2° 视场大小的视锥光能基础响应.html-f259b64c.js" as="script"><link rel="prefetch" href="/assets/数据：2° 视场大小的视锥化学能基础响应.html-214f8c7a.js" as="script"><link rel="prefetch" href="/assets/数据：2°.CIE.1931.XYZ系统光谱三刺激值.html-be18b05c.js" as="script"><link rel="prefetch" href="/assets/L1.什么是操作系统.html-3f27e50d.js" as="script"><link rel="prefetch" href="/assets/404.html-81de84fb.js" as="script"><link rel="prefetch" href="/assets/index.html-df04ee16.js" as="script"><link rel="prefetch" href="/assets/index.html-a2d9646c.js" as="script"><link rel="prefetch" href="/assets/index.html-2dd4e9a1.js" as="script"><link rel="prefetch" href="/assets/index.html-55868e76.js" as="script"><link rel="prefetch" href="/assets/index.html-11fda04a.js" as="script"><link rel="prefetch" href="/assets/index.html-b7ae1dda.js" as="script"><link rel="prefetch" href="/assets/index.html-adeaf5a0.js" as="script"><link rel="prefetch" href="/assets/index.html-85833432.js" as="script"><link rel="prefetch" href="/assets/index.html-954f0c3f.js" as="script"><link rel="prefetch" href="/assets/index.html-adbb2503.js" as="script"><link rel="prefetch" href="/assets/index.html-49797614.js" as="script"><link rel="prefetch" href="/assets/index.html-ca88f71e.js" as="script"><link rel="prefetch" href="/assets/index.html-a2c37c05.js" as="script"><link rel="prefetch" href="/assets/index.html-6ae31aff.js" as="script"><link rel="prefetch" href="/assets/index.html-3f512a29.js" as="script"><link rel="prefetch" href="/assets/index.html-7adacce5.js" as="script"><link rel="prefetch" href="/assets/index.html-73d95ed2.js" as="script"><link rel="prefetch" href="/assets/index.html-5817c93b.js" as="script"><link rel="prefetch" href="/assets/index.html-bb6daf91.js" as="script"><link rel="prefetch" href="/assets/index.html-2aef8cab.js" as="script"><link rel="prefetch" href="/assets/index.html-e918fb82.js" as="script"><link rel="prefetch" href="/assets/index.html-b3e4aa37.js" as="script"><link rel="prefetch" href="/assets/index.html-5d09d26d.js" as="script"><link rel="prefetch" href="/assets/index.html-065cf38d.js" as="script"><link rel="prefetch" href="/assets/index.html-a92f9841.js" as="script"><link rel="prefetch" href="/assets/index.html-68eca9e0.js" as="script"><link rel="prefetch" href="/assets/index.html-43bec9dc.js" as="script"><link rel="prefetch" href="/assets/index.html-bb9a5a0c.js" as="script"><link rel="prefetch" href="/assets/index.html-4dfa994a.js" as="script"><link rel="prefetch" href="/assets/index.html-6407f86c.js" as="script"><link rel="prefetch" href="/assets/index.html-82a0cf13.js" as="script"><link rel="prefetch" href="/assets/index.html-4e4aecd2.js" as="script"><link rel="prefetch" href="/assets/index.html-e7ea063e.js" as="script"><link rel="prefetch" href="/assets/index.html-a55ae107.js" as="script"><link rel="prefetch" href="/assets/index.html-6031e54c.js" as="script"><link rel="prefetch" href="/assets/index.html-130ce4bf.js" as="script"><link rel="prefetch" href="/assets/index.html-34b56a58.js" as="script"><link rel="prefetch" href="/assets/index.html-267d5a42.js" as="script"><link rel="prefetch" href="/assets/index.html-cac08cfd.js" as="script"><link rel="prefetch" href="/assets/index.html-ed6c5516.js" as="script"><link rel="prefetch" href="/assets/index.html-d5b84911.js" as="script"><link rel="prefetch" href="/assets/index.html-c6efa200.js" as="script"><link rel="prefetch" href="/assets/index.html-d0031563.js" as="script"><link rel="prefetch" href="/assets/index.html-d4f523f2.js" as="script"><link rel="prefetch" href="/assets/index.html-a908d03b.js" as="script"><link rel="prefetch" href="/assets/index.html-48aa1e73.js" as="script"><link rel="prefetch" href="/assets/index.html-1bb01f7e.js" as="script"><link rel="prefetch" href="/assets/index.html-7ca08b60.js" as="script"><link rel="prefetch" href="/assets/index.html-d22d293d.js" as="script"><link rel="prefetch" href="/assets/index.html-93b99ca3.js" as="script"><link rel="prefetch" href="/assets/index.html-133b554e.js" as="script"><link rel="prefetch" href="/assets/index.html-03d0d93a.js" as="script"><link rel="prefetch" href="/assets/index.html-5ffa48a2.js" as="script"><link rel="prefetch" href="/assets/index.html-42432e3b.js" as="script"><link rel="prefetch" href="/assets/index.html-08055731.js" as="script"><link rel="prefetch" href="/assets/index.html-d35e4e45.js" as="script"><link rel="prefetch" href="/assets/index.html-1deae25f.js" as="script"><link rel="prefetch" href="/assets/index.html-69b65684.js" as="script"><link rel="prefetch" href="/assets/index.html-c8a5c4f7.js" as="script"><link rel="prefetch" href="/assets/index.html-d91558f5.js" as="script"><link rel="prefetch" href="/assets/index.html-a238749b.js" as="script"><link rel="prefetch" href="/assets/index.html-339e0ba8.js" as="script"><link rel="prefetch" href="/assets/index.html-e619fb96.js" as="script"><link rel="prefetch" href="/assets/index.html-ada432f6.js" as="script"><link rel="prefetch" href="/assets/index.html-ed832418.js" as="script"><link rel="prefetch" href="/assets/index.html-dbb371c6.js" as="script"><link rel="prefetch" href="/assets/index.html-9e13a72d.js" as="script"><link rel="prefetch" href="/assets/index.html-739d2392.js" as="script"><link rel="prefetch" href="/assets/index.html-d12a8922.js" as="script"><link rel="prefetch" href="/assets/index.html-691b705d.js" as="script"><link rel="prefetch" href="/assets/index.html-eb05b6d4.js" as="script"><link rel="prefetch" href="/assets/index.html-81123c1b.js" as="script"><link rel="prefetch" href="/assets/index.html-c997cc01.js" as="script"><link rel="prefetch" href="/assets/index.html-f4b73d65.js" as="script"><link rel="prefetch" href="/assets/index.html-8d232b42.js" as="script"><link rel="prefetch" href="/assets/index.html-075fc650.js" as="script"><link rel="prefetch" href="/assets/index.html-40948553.js" as="script"><link rel="prefetch" href="/assets/intro.html-a1901505.js" as="script"><link rel="prefetch" href="/assets/slides.html-59032a65.js" as="script"><link rel="prefetch" href="/assets/slidesOld.html-86de0da8.js" as="script"><link rel="prefetch" href="/assets/index.html-7c6f1102.js" as="script"><link rel="prefetch" href="/assets/mg.html-abbc8572.js" as="script"><link rel="prefetch" href="/assets/mg.html-29434a6f.js" as="script"><link rel="prefetch" href="/assets/index.html-48031c85.js" as="script"><link rel="prefetch" href="/assets/中华田园文化.html-068e28e7.js" as="script"><link rel="prefetch" href="/assets/NormalDay.html-b4e009e3.js" as="script"><link rel="prefetch" href="/assets/index.html-6ec54a2c.js" as="script"><link rel="prefetch" href="/assets/争与不争.html-190639e9.js" as="script"><link rel="prefetch" href="/assets/和气生财.html-bcbef8e6.js" as="script"><link rel="prefetch" href="/assets/闷声发大财.html-4030dc41.js" as="script"><link rel="prefetch" href="/assets/index.html-51f60a44.js" as="script"><link rel="prefetch" href="/assets/github.html-0ebd6333.js" as="script"><link rel="prefetch" href="/assets/高速摄像头资源.html-82f9107f.js" as="script"><link rel="prefetch" href="/assets/浏览器收藏夹-脚本.html-3980a57a.js" as="script"><link rel="prefetch" href="/assets/course.html-1fdd61cb.js" as="script"><link rel="prefetch" href="/assets/index.html-49be9c56.js" as="script"><link rel="prefetch" href="/assets/me.html-3b8e6ef6.js" as="script"><link rel="prefetch" href="/assets/index.html-4648d288.js" as="script"><link rel="prefetch" href="/assets/index.html-9829bc5b.js" as="script"><link rel="prefetch" href="/assets/基础知识：配色原理.html-0f148c78.js" as="script"><link rel="prefetch" href="/assets/背景知识：色学发展时间表.html-c24dd242.js" as="script"><link rel="prefetch" href="/assets/课程知识：颜色科学.html-5dc109af.js" as="script"><link rel="prefetch" href="/assets/Setting.html-48fc6cb9.js" as="script"><link rel="prefetch" href="/assets/Snippets.html-5b7e4891.js" as="script"><link rel="prefetch" href="/assets/程序员常用英语词汇.html-d7e9ed5c.js" as="script"><link rel="prefetch" href="/assets/计算机编程及常用术语英语词汇大全.html-bccc1fa4.js" as="script"><link rel="prefetch" href="/assets/1114路由器默认密码.html-1938cb9b.js" as="script"><link rel="prefetch" href="/assets/dism安装脚本.html-b0f71306.js" as="script"><link rel="prefetch" href="/assets/ChromeExtension.html-2f083315.js" as="script"><link rel="prefetch" href="/assets/Git with SSH.html-84fd6acf.js" as="script"><link rel="prefetch" href="/assets/AI工具.html-7accba64.js" as="script"><link rel="prefetch" href="/assets/时空葫芦工具箱.html-3b227705.js" as="script"><link rel="prefetch" href="/assets/音乐番茄果果果.html-6148e2fa.js" as="script"><link rel="prefetch" href="/assets/《周公解梦》.html-366651bd.js" as="script"><link rel="prefetch" href="/assets/《敦煌本梦书》.html-95697286.js" as="script"><link rel="prefetch" href="/assets/《断梦秘书》.html-68548940.js" as="script"><link rel="prefetch" href="/assets/《入药镜》.html-287888b5.js" as="script"><link rel="prefetch" href="/assets/index.html-94eee020.js" as="script"><link rel="prefetch" href="/assets/一般广告违禁词.html-6407d8f0.js" as="script"><link rel="prefetch" href="/assets/中华人民共和国广告法.html-2188a79d.js" as="script"><link rel="prefetch" href="/assets/互联网广告管理办法.html-aa5dd057.js" as="script"><link rel="prefetch" href="/assets/index.html-34c5d9e1.js" as="script"><link rel="prefetch" href="/assets/中华人民共和国著作权法（2020）.html-cbd07301.js" as="script"><link rel="prefetch" href="/assets/中国版权保护中心著作权自愿登记收费标准.html-63d53c00.js" as="script"><link rel="prefetch" href="/assets/index.html-b1ae3946.js" as="script"><link rel="prefetch" href="/assets/disrupt.html-725f8cf2.js" as="script"><link rel="prefetch" href="/assets/lane.html-aa1da54d.js" as="script"><link rel="prefetch" href="/assets/prepare.html-3e5e488a.js" as="script"><link rel="prefetch" href="/assets/scheduler.html-fb89f887.js" as="script"><link rel="prefetch" href="/assets/multi.html-794d9157.js" as="script"><link rel="prefetch" href="/assets/one.html-f7b4f18f.js" as="script"><link rel="prefetch" href="/assets/prepare.html-ab2f8c56.js" as="script"><link rel="prefetch" href="/assets/create.html-5364654e.js" as="script"><link rel="prefetch" href="/assets/prepare.html-4aab6d6a.js" as="script"><link rel="prefetch" href="/assets/structure.html-7494e754.js" as="script"><link rel="prefetch" href="/assets/useeffect.html-b60a9df8.js" as="script"><link rel="prefetch" href="/assets/usememo.html-80e7cbbc.js" as="script"><link rel="prefetch" href="/assets/useref.html-2f0dd70a.js" as="script"><link rel="prefetch" href="/assets/usestate.html-f771e7b0.js" as="script"><link rel="prefetch" href="/assets/file.html-effa6e1c.js" as="script"><link rel="prefetch" href="/assets/idea.html-c73dc687.js" as="script"><link rel="prefetch" href="/assets/jsx.html-8695d734.js" as="script"><link rel="prefetch" href="/assets/newConstructure.html-f4b971d2.js" as="script"><link rel="prefetch" href="/assets/oldConstructure.html-b8c4efee.js" as="script"><link rel="prefetch" href="/assets/source.html-d456bd09.js" as="script"><link rel="prefetch" href="/assets/summary.html-35720017.js" as="script"><link rel="prefetch" href="/assets/beginWork.html-10e0102d.js" as="script"><link rel="prefetch" href="/assets/completeWork.html-f2290b4b.js" as="script"><link rel="prefetch" href="/assets/doubleBuffer.html-f6a46a2b.js" as="script"><link rel="prefetch" href="/assets/fiber-mental.html-3873a5a7.js" as="script"><link rel="prefetch" href="/assets/fiber.html-d844e87c.js" as="script"><link rel="prefetch" href="/assets/reconciler.html-1a186ab8.js" as="script"><link rel="prefetch" href="/assets/mental.html-4d5723df.js" as="script"><link rel="prefetch" href="/assets/prepare.html-dc12b884.js" as="script"><link rel="prefetch" href="/assets/priority.html-8d840c0d.js" as="script"><link rel="prefetch" href="/assets/reactdom.html-cc10fbbe.js" as="script"><link rel="prefetch" href="/assets/setstate.html-3dadcc0b.js" as="script"><link rel="prefetch" href="/assets/update.html-e4dedfc4.js" as="script"><link rel="prefetch" href="/assets/beforeMutation.html-10c0b563.js" as="script"><link rel="prefetch" href="/assets/layout.html-3683c363.js" as="script"><link rel="prefetch" href="/assets/mutation.html-2ec385e7.js" as="script"><link rel="prefetch" href="/assets/prepare.html-655ba0be.js" as="script"><link rel="prefetch" href="/assets/codegen.html-2c62147c.js" as="script"><link rel="prefetch" href="/assets/entrance.html-663b3b41.js" as="script"><link rel="prefetch" href="/assets/index.html-3fa09136.js" as="script"><link rel="prefetch" href="/assets/optimize.html-3a323512.js" as="script"><link rel="prefetch" href="/assets/parse.html-00dff523.js" as="script"><link rel="prefetch" href="/assets/async-component.html-0fe922a1.js" as="script"><link rel="prefetch" href="/assets/component-register.html-e943ddd9.js" as="script"><link rel="prefetch" href="/assets/create-component.html-ebaec33d.js" as="script"><link rel="prefetch" href="/assets/index.html-4fcb4041.js" as="script"><link rel="prefetch" href="/assets/lifecycle.html-3a516eef.js" as="script"><link rel="prefetch" href="/assets/merge-option.html-f1ea4abe.js" as="script"><link rel="prefetch" href="/assets/patch.html-50a8a837.js" as="script"><link rel="prefetch" href="/assets/create-element.html-13d715b0.js" as="script"><link rel="prefetch" href="/assets/index.html-3090092a.js" as="script"><link rel="prefetch" href="/assets/mounted.html-4c86d08b.js" as="script"><link rel="prefetch" href="/assets/new-vue.html-0608b504.js" as="script"><link rel="prefetch" href="/assets/render.html-c60c947c.js" as="script"><link rel="prefetch" href="/assets/update.html-549101b2.js" as="script"><link rel="prefetch" href="/assets/virtual-dom.html-a29bc520.js" as="script"><link rel="prefetch" href="/assets/event.html-60223e95.js" as="script"><link rel="prefetch" href="/assets/index.html-5a639663.js" as="script"><link rel="prefetch" href="/assets/keep-alive.html-92e56f1d.js" as="script"><link rel="prefetch" href="/assets/slot.html-7145aa73.js" as="script"><link rel="prefetch" href="/assets/tansition-group.html-b909da90.js" as="script"><link rel="prefetch" href="/assets/tansition.html-ba9660dc.js" as="script"><link rel="prefetch" href="/assets/v-model.html-0afdfd3f.js" as="script"><link rel="prefetch" href="/assets/build.html-32b6320f.js" as="script"><link rel="prefetch" href="/assets/directory.html-4f78f828.js" as="script"><link rel="prefetch" href="/assets/entrance.html-554ccfd8.js" as="script"><link rel="prefetch" href="/assets/flow.html-0418aa77.js" as="script"><link rel="prefetch" href="/assets/index.html-2eeed8a4.js" as="script"><link rel="prefetch" href="/assets/component-update.html-0f6c7278.js" as="script"><link rel="prefetch" href="/assets/getters.html-5d5f942c.js" as="script"><link rel="prefetch" href="/assets/index.html-8c3a1d06.js" as="script"><link rel="prefetch" href="/assets/next-tick.html-d78db5b3.js" as="script"><link rel="prefetch" href="/assets/props.html-5626af6b.js" as="script"><link rel="prefetch" href="/assets/questions.html-63490d9f.js" as="script"><link rel="prefetch" href="/assets/reactive-object.html-c8db4810.js" as="script"><link rel="prefetch" href="/assets/setters.html-1e0fb74c.js" as="script"><link rel="prefetch" href="/assets/summary.html-385ec33f.js" as="script"><link rel="prefetch" href="/assets/index.html-c72d9c20.js" as="script"><link rel="prefetch" href="/assets/install.html-2ce86199.js" as="script"><link rel="prefetch" href="/assets/matcher.html-eb2f6ab6.js" as="script"><link rel="prefetch" href="/assets/router.html-0a8c00ca.js" as="script"><link rel="prefetch" href="/assets/transition-to.html-9b555286.js" as="script"><link rel="prefetch" href="/assets/api.html-c6649d53.js" as="script"><link rel="prefetch" href="/assets/index.html-8dac2ec5.js" as="script"><link rel="prefetch" href="/assets/init.html-6eaa92cf.js" as="script"><link rel="prefetch" href="/assets/plugin.html-e15260e2.js" as="script"><link rel="prefetch" href="/assets/ast.html-84a4ea03.js" as="script"><link rel="prefetch" href="/assets/binder.html-924376db.js" as="script"><link rel="prefetch" href="/assets/checker.html-dd610814.js" as="script"><link rel="prefetch" href="/assets/emitter.html-2cdb8afa.js" as="script"><link rel="prefetch" href="/assets/overview.html-2abe7efb.js" as="script"><link rel="prefetch" href="/assets/parser.html-f3e43a99.js" as="script"><link rel="prefetch" href="/assets/program.html-b43cf227.js" as="script"><link rel="prefetch" href="/assets/scanner.html-77ac399b.js" as="script"><link rel="prefetch" href="/assets/common.html-8f558a02.js" as="script"><link rel="prefetch" href="/assets/interpreting.html-f4010327.js" as="script"><link rel="prefetch" href="/assets/class.html-067e7f4f.js" as="script"><link rel="prefetch" href="/assets/commandline-behavior.html-52b6a992.js" as="script"><link rel="prefetch" href="/assets/comments.html-9ce440c0.js" as="script"><link rel="prefetch" href="/assets/common-bug-not-bugs.html-89809438.js" as="script"><link rel="prefetch" href="/assets/common-feature-request.html-78b251b8.js" as="script"><link rel="prefetch" href="/assets/decorators.html-cd743ae0.js" as="script"><link rel="prefetch" href="/assets/enums.html-3571aa1b.js" as="script"><link rel="prefetch" href="/assets/function.html-3f67d1b2.js" as="script"><link rel="prefetch" href="/assets/generics.html-175c06cc.js" as="script"><link rel="prefetch" href="/assets/glossary-and-terms.html-8e65a586.js" as="script"><link rel="prefetch" href="/assets/jsx-and-react.html-0ab4d559.js" as="script"><link rel="prefetch" href="/assets/modules.html-88cc5b9c.js" as="script"><link rel="prefetch" href="/assets/thing-that-dont-work.html-430c46be.js" as="script"><link rel="prefetch" href="/assets/tsconfig-behavior.html-0e02b83e.js" as="script"><link rel="prefetch" href="/assets/type-guards.html-0b611128.js" as="script"><link rel="prefetch" href="/assets/type-system-behavior.html-cbcd8951.js" as="script"><link rel="prefetch" href="/assets/nonReactJSX.html-90132612.js" as="script"><link rel="prefetch" href="/assets/reactJSX.html-ed360d81.js" as="script"><link rel="prefetch" href="/assets/support.html-9179a417.js" as="script"><link rel="prefetch" href="/assets/typescript-3.7.html-fa0266a1.js" as="script"><link rel="prefetch" href="/assets/typescript-3.8.html-8e561abd.js" as="script"><link rel="prefetch" href="/assets/typescript-3.9.html-9d2cca1c.js" as="script"><link rel="prefetch" href="/assets/compilationContext.html-0e5aa55c.js" as="script"><link rel="prefetch" href="/assets/declarationspaces.html-aa3e03ff.js" as="script"><link rel="prefetch" href="/assets/dynamicImportExpressions.html-1f8d5e21.js" as="script"><link rel="prefetch" href="/assets/modules.html-9a082641.js" as="script"><link rel="prefetch" href="/assets/namespaces.html-c976b166.js" as="script"><link rel="prefetch" href="/assets/avoidExportDefault.html-f615ac35.js" as="script"><link rel="prefetch" href="/assets/barrel.html-e8e3bc86.js" as="script"><link rel="prefetch" href="/assets/bind.html-41eca47a.js" as="script"><link rel="prefetch" href="/assets/buildToggles.html-0170f7de.js" as="script"><link rel="prefetch" href="/assets/classAreUseful.html-7334e360.js" as="script"><link rel="prefetch" href="/assets/covarianceAndContravariance.html-f4492f4b.js" as="script"><link rel="prefetch" href="/assets/createArrays.html-1879df14.js" as="script"><link rel="prefetch" href="/assets/curry.html-b9d33ab7.js" as="script"><link rel="prefetch" href="/assets/functionParameters.html-baf0958e.js" as="script"><link rel="prefetch" href="/assets/infer.html-298c002c.js" as="script"><link rel="prefetch" href="/assets/lazyObjectLiteralInitialization.html-f80d9bba.js" as="script"><link rel="prefetch" href="/assets/limitPropertySetters.html-77af92eb.js" as="script"><link rel="prefetch" href="/assets/metadata.html-acdf7570.js" as="script"><link rel="prefetch" href="/assets/nominalTyping.html-e3b2ee2e.js" as="script"><link rel="prefetch" href="/assets/outFileCaution.html-674274cf.js" as="script"><link rel="prefetch" href="/assets/singletonPatern.html-5fcdd5b6.js" as="script"><link rel="prefetch" href="/assets/statefulFunctions.html-ed1cd36f.js" as="script"><link rel="prefetch" href="/assets/staticConstructors.html-1647806e.js" as="script"><link rel="prefetch" href="/assets/stringBasedEmuns.html-13b90dd6.js" as="script"><link rel="prefetch" href="/assets/truthy.html-051fdcd2.js" as="script"><link rel="prefetch" href="/assets/typeInstantiation.html-fb88ad76.js" as="script"><link rel="prefetch" href="/assets/typesafeEventEmitter.html-97a56334.js" as="script"><link rel="prefetch" href="/assets/ambient.html-0a0ea25d.js" as="script"><link rel="prefetch" href="/assets/callable.html-bb96f78f.js" as="script"><link rel="prefetch" href="/assets/discrominatedUnion.html-12c304fe.js" as="script"><link rel="prefetch" href="/assets/enums.html-9cfc6774.js" as="script"><link rel="prefetch" href="/assets/exceptionsHanding.html-2c0c8e05.js" as="script"><link rel="prefetch" href="/assets/freshness.html-d5a066ac.js" as="script"><link rel="prefetch" href="/assets/functions.html-488baba2.js" as="script"><link rel="prefetch" href="/assets/generices.html-977e80d5.js" as="script"><link rel="prefetch" href="/assets/indexSignatures.html-14e17d21.js" as="script"><link rel="prefetch" href="/assets/interfaces.html-4b2beb8c.js" as="script"><link rel="prefetch" href="/assets/lib.html-122306ae.js" as="script"><link rel="prefetch" href="/assets/literals.html-65a05970.js" as="script"><link rel="prefetch" href="/assets/migrating.html-695f6707.js" as="script"><link rel="prefetch" href="/assets/mixins.html-6b19d599.js" as="script"><link rel="prefetch" href="/assets/movingTypes.html-6bd3519d.js" as="script"><link rel="prefetch" href="/assets/neverType.html-9431cb0a.js" as="script"><link rel="prefetch" href="/assets/overview.html-cd358063.js" as="script"><link rel="prefetch" href="/assets/readonly.html-83c1540b.js" as="script"><link rel="prefetch" href="/assets/thisType.html-9d5fe169.js" as="script"><link rel="prefetch" href="/assets/typeAssertion.html-31d125eb.js" as="script"><link rel="prefetch" href="/assets/typeCompatibility.html-42bfa172.js" as="script"><link rel="prefetch" href="/assets/typeGuard.html-f8e7801d.js" as="script"><link rel="prefetch" href="/assets/typeInference.html-37709765.js" as="script"><link rel="prefetch" href="/assets/types.html-c0417ae3.js" as="script"><link rel="prefetch" href="/assets/CIE 1931 XYZ色彩空间详解.html-c7346760.js" as="script"><link rel="prefetch" href="/assets/CIE 色度出版物（中英文）2018.html-553acb35.js" as="script"><link rel="prefetch" href="/assets/CIE.1931.COLOUR-MATCHING.FUNCTIONS.2.DEGREE.OBSERVE.html-d471527d.js" as="script"><link rel="prefetch" href="/assets/CIE170-1(CIE2006a)颜色匹配函数计算模型.html-4c04d161.js" as="script"><link rel="prefetch" href="/assets/根据功率频谱准确绘制 LED 颜色 - 文章资源.html-1b974917.js" as="script"><link rel="prefetch" href="/assets/工具：函数图像工具.html-33b87efe.js" as="script"><link rel="prefetch" href="/assets/案例大全.html-bbb64ad6.js" as="script"><link rel="prefetch" href="/assets/图标：vuepress-temp-hope.html-89f1cc73.js" as="script"><link rel="prefetch" href="/assets/课程介绍.html-0288bed6.js" as="script"><link rel="prefetch" href="/assets/html-css.html-2d3172cc.js" as="script"><link rel="prefetch" href="/assets/javascript.html-b7398716.js" as="script"><link rel="prefetch" href="/assets/password.html-a278bc2a.js" as="script"><link rel="prefetch" href="/assets/Base64.html-f6d7cf49.js" as="script"><link rel="prefetch" href="/assets/Color.html-2d1ab050.js" as="script"><link rel="prefetch" href="/assets/UUID.html-1c49e5bf.js" as="script"><link rel="prefetch" href="/assets/audioAnalyser.html-5bf14c28.js" as="script"><link rel="prefetch" href="/assets/deep.clone.html-80b45cfe.js" as="script"><link rel="prefetch" href="/assets/download.html-ceda753e.js" as="script"><link rel="prefetch" href="/assets/format.html-0d18f38c.js" as="script"><link rel="prefetch" href="/assets/iframe.html-f4254577.js" as="script"><link rel="prefetch" href="/assets/loadjs.html-40d0fbd9.js" as="script"><link rel="prefetch" href="/assets/parseToJson.html-8f343665.js" as="script"><link rel="prefetch" href="/assets/getComputedStyle.html-1a5d6b1d.js" as="script"><link rel="prefetch" href="/assets/localeCompare.html-6771d5ad.js" as="script"><link rel="prefetch" href="/assets/图像：2° coordinates from 2°  XYZ CMFs.html-8a1914e9.js" as="script"><link rel="prefetch" href="/assets/图像：2°.CIE.1931.RGB系统光谱三刺激值曲线.html-9615d4cd.js" as="script"><link rel="prefetch" href="/assets/图像：2°.CIE.1931.XYZ系统光谱三刺激值曲线.html-9e79d3fd.js" as="script"><link rel="prefetch" href="/assets/数据：2° 视场大小的视锥光能基础响应.html-a92334ea.js" as="script"><link rel="prefetch" href="/assets/数据：2° 视场大小的视锥化学能基础响应.html-c83ff530.js" as="script"><link rel="prefetch" href="/assets/数据：2°.CIE.1931.XYZ系统光谱三刺激值.html-1df00ff9.js" as="script"><link rel="prefetch" href="/assets/L1.什么是操作系统.html-bf5b184e.js" as="script"><link rel="prefetch" href="/assets/404.html-9f7a3bbd.js" as="script"><link rel="prefetch" href="/assets/index.html-bf939b93.js" as="script"><link rel="prefetch" href="/assets/index.html-a13c164c.js" as="script"><link rel="prefetch" href="/assets/index.html-22400f70.js" as="script"><link rel="prefetch" href="/assets/index.html-ac63dc9f.js" as="script"><link rel="prefetch" href="/assets/index.html-dccd8f0f.js" as="script"><link rel="prefetch" href="/assets/index.html-64348cf8.js" as="script"><link rel="prefetch" href="/assets/index.html-3d193b87.js" as="script"><link rel="prefetch" href="/assets/index.html-2358fd32.js" as="script"><link rel="prefetch" href="/assets/index.html-d13beacc.js" as="script"><link rel="prefetch" href="/assets/index.html-393e8ef9.js" as="script"><link rel="prefetch" href="/assets/index.html-98301bc9.js" as="script"><link rel="prefetch" href="/assets/index.html-4cc9ead9.js" as="script"><link rel="prefetch" href="/assets/index.html-452226b3.js" as="script"><link rel="prefetch" href="/assets/index.html-47108c45.js" as="script"><link rel="prefetch" href="/assets/index.html-af63752d.js" as="script"><link rel="prefetch" href="/assets/index.html-2e4e2240.js" as="script"><link rel="prefetch" href="/assets/index.html-1922d8b1.js" as="script"><link rel="prefetch" href="/assets/index.html-f9b2460f.js" as="script"><link rel="prefetch" href="/assets/index.html-555754ab.js" as="script"><link rel="prefetch" href="/assets/index.html-d20ae458.js" as="script"><link rel="prefetch" href="/assets/index.html-af84651a.js" as="script"><link rel="prefetch" href="/assets/index.html-c057231f.js" as="script"><link rel="prefetch" href="/assets/index.html-99197cf7.js" as="script"><link rel="prefetch" href="/assets/index.html-16bdcc27.js" as="script"><link rel="prefetch" href="/assets/index.html-3bc8fe50.js" as="script"><link rel="prefetch" href="/assets/index.html-58ba55dd.js" as="script"><link rel="prefetch" href="/assets/index.html-0d5c82c0.js" as="script"><link rel="prefetch" href="/assets/index.html-4c707bd0.js" as="script"><link rel="prefetch" href="/assets/index.html-a596449e.js" as="script"><link rel="prefetch" href="/assets/index.html-55b00cdf.js" as="script"><link rel="prefetch" href="/assets/index.html-e04dbee2.js" as="script"><link rel="prefetch" href="/assets/index.html-8a8ff562.js" as="script"><link rel="prefetch" href="/assets/index.html-94be720f.js" as="script"><link rel="prefetch" href="/assets/index.html-e6476df7.js" as="script"><link rel="prefetch" href="/assets/index.html-cf88d270.js" as="script"><link rel="prefetch" href="/assets/index.html-08f05241.js" as="script"><link rel="prefetch" href="/assets/index.html-0367ecde.js" as="script"><link rel="prefetch" href="/assets/index.html-dee0fb6b.js" as="script"><link rel="prefetch" href="/assets/index.html-2bed6ee1.js" as="script"><link rel="prefetch" href="/assets/index.html-9247120b.js" as="script"><link rel="prefetch" href="/assets/index.html-a2833308.js" as="script"><link rel="prefetch" href="/assets/index.html-1f15b3b9.js" as="script"><link rel="prefetch" href="/assets/index.html-5b450b12.js" as="script"><link rel="prefetch" href="/assets/index.html-06b65b0d.js" as="script"><link rel="prefetch" href="/assets/index.html-35e4a13b.js" as="script"><link rel="prefetch" href="/assets/index.html-77cf79bb.js" as="script"><link rel="prefetch" href="/assets/index.html-2c4821ee.js" as="script"><link rel="prefetch" href="/assets/index.html-50d3f296.js" as="script"><link rel="prefetch" href="/assets/index.html-6d31ddf6.js" as="script"><link rel="prefetch" href="/assets/index.html-b12a454b.js" as="script"><link rel="prefetch" href="/assets/index.html-3b7819b3.js" as="script"><link rel="prefetch" href="/assets/index.html-3b1cad37.js" as="script"><link rel="prefetch" href="/assets/index.html-151e449e.js" as="script"><link rel="prefetch" href="/assets/index.html-a2ba50e9.js" as="script"><link rel="prefetch" href="/assets/index.html-3ed3b661.js" as="script"><link rel="prefetch" href="/assets/index.html-479c466b.js" as="script"><link rel="prefetch" href="/assets/index.html-20d9dbc2.js" as="script"><link rel="prefetch" href="/assets/index.html-487db8f4.js" as="script"><link rel="prefetch" href="/assets/index.html-2527308d.js" as="script"><link rel="prefetch" href="/assets/index.html-e74a45c9.js" as="script"><link rel="prefetch" href="/assets/index.html-666b31ce.js" as="script"><link rel="prefetch" href="/assets/index.html-3475b855.js" as="script"><link rel="prefetch" href="/assets/index.html-2a95b0e6.js" as="script"><link rel="prefetch" href="/assets/index.html-571d22fa.js" as="script"><link rel="prefetch" href="/assets/index.html-41ff7667.js" as="script"><link rel="prefetch" href="/assets/index.html-e834ad94.js" as="script"><link rel="prefetch" href="/assets/index.html-404e8806.js" as="script"><link rel="prefetch" href="/assets/index.html-1b3cdee2.js" as="script"><link rel="prefetch" href="/assets/index.html-cfc22104.js" as="script"><link rel="prefetch" href="/assets/index.html-cd93bbd6.js" as="script"><link rel="prefetch" href="/assets/index.html-40a6dae1.js" as="script"><link rel="prefetch" href="/assets/index.html-135ee1f0.js" as="script"><link rel="prefetch" href="/assets/index.html-11311f89.js" as="script"><link rel="prefetch" href="/assets/index.html-1b45c64e.js" as="script"><link rel="prefetch" href="/assets/index.html-690a004c.js" as="script"><link rel="prefetch" href="/assets/index.html-6fcb6951.js" as="script"><link rel="prefetch" href="/assets/giscus-f311b0ba.js" as="script"><link rel="prefetch" href="/assets/auto-ba5ecab5.js" as="script"><link rel="prefetch" href="/assets/index-b03bef79.js" as="script"><link rel="prefetch" href="/assets/flowchart-8b576787.js" as="script"><link rel="prefetch" href="/assets/mermaid.core-7426a035.js" as="script"><link rel="prefetch" href="/assets/highlight.esm-75b11b9d.js" as="script"><link rel="prefetch" href="/assets/markdown.esm-0191f9da.js" as="script"><link rel="prefetch" href="/assets/math.esm-70a288c8.js" as="script"><link rel="prefetch" href="/assets/notes.esm-a106bb2c.js" as="script"><link rel="prefetch" href="/assets/reveal.esm-ab04f0b1.js" as="script"><link rel="prefetch" href="/assets/search.esm-7e6792e2.js" as="script"><link rel="prefetch" href="/assets/zoom.esm-b83b91d0.js" as="script"><link rel="prefetch" href="/assets/VuePlayground-d2c31c24.js" as="script"><link rel="prefetch" href="/assets/photoswipe.esm-36cd6c3c.js" as="script"><link rel="prefetch" href="/assets/SearchResult-a75a8ec5.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="skip-link sr-only">跳至主要內容</a><!--]--><div class="theme-container has-toc"><!--[--><header class="navbar" id="navbar"><div class="navbar-start"><button type="button" class="toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><!----><!--]--><!--[--><a href="/" class="brand"><img class="logo" src="/assets/avatar/cat.webp" alt="魔法Bug"><!----><span class="site-name hide-in-pad">魔法Bug</span></a><!--]--><!--[--><!----><!--]--></div><div class="navbar-center"><!--[--><!----><!--]--><!--[--><nav class="nav-links"><div class="nav-item hide-in-mobile"><a href="/" class="nav-link" aria-label="主页"><span class="font-icon icon iconfont icon-home" style=""></span>主页<!----></a></div><div class="nav-item hide-in-mobile"><a href="/views/Posts/" class="nav-link" aria-label="博文"><span class="font-icon icon iconfont icon-hot" style=""></span>博文<!----></a></div><div class="nav-item hide-in-mobile"><a href="/views/DevLog/" class="nav-link" aria-label="开发日志"><span class="font-icon icon iconfont icon-IO" style=""></span>开发日志<!----></a></div><div class="nav-item hide-in-mobile"><a href="/views/Share/" class="nav-link" aria-label="数字宝库"><span class="font-icon icon iconfont icon-launch" style=""></span>数字宝库<!----></a></div><div class="nav-item hide-in-mobile"><a href="/views/Books/" class="nav-link active" aria-label="藏书阁"><span class="font-icon icon iconfont icon-repo" style=""></span>藏书阁<!----></a></div></nav><!--]--><!--[--><!----><!--]--></div><div class="navbar-end"><!--[--><!----><!--]--><!--[--><!----><div class="nav-item"><a class="repo-link" href="https://gitee.com/mpbug/mpbug" target="_blank" rel="noopener noreferrer" aria-label="Gitee"><svg xmlns="http://www.w3.org/2000/svg" class="icon gitee-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="gitee icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm242.97-533.34H482.39a23.7 23.7 0 0 0-23.7 23.7l-.03 59.28c0 13.08 10.59 23.7 23.7 23.7h165.96a23.7 23.7 0 0 1 23.7 23.7v11.85a71.1 71.1 0 0 1-71.1 71.1H375.71a23.7 23.7 0 0 1-23.7-23.7V423.11a71.1 71.1 0 0 1 71.1-71.1h331.8a23.7 23.7 0 0 0 23.7-23.7l.06-59.25a23.73 23.73 0 0 0-23.7-23.73H423.11a177.78 177.78 0 0 0-177.78 177.75v331.83c0 13.08 10.62 23.7 23.7 23.7h349.62a159.99 159.99 0 0 0 159.99-159.99V482.33a23.7 23.7 0 0 0-23.7-23.7z"></path></svg></a></div><div class="nav-item hide-in-mobile"><button type="button" id="appearance-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="light icon" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><!--[--><button type="button" class="search-pro-button" role="search" aria-label="搜索"><svg xmlns="http://www.w3.org/2000/svg" class="icon search-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="search icon"><path d="M192 480a256 256 0 1 1 512 0 256 256 0 0 1-512 0m631.776 362.496-143.2-143.168A318.464 318.464 0 0 0 768 480c0-176.736-143.264-320-320-320S128 303.264 128 480s143.264 320 320 320a318.016 318.016 0 0 0 184.16-58.592l146.336 146.368c12.512 12.48 32.768 12.48 45.28 0 12.48-12.512 12.48-32.768 0-45.28"></path></svg><div class="placeholder">搜索</div><div class="key-hints"><kbd class="key">Ctrl</kbd><kbd class="key">K</kbd></div></button><!--]--><!--]--><!--[--><!----><!--]--><button type="button" class="toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span class="button-container"><span class="button-top"></span><span class="button-middle"></span><span class="button-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside class="sidebar" id="sidebar"><!--[--><!----><!--]--><ul class="sidebar-links"><li><section class="sidebar-group"><button class="sidebar-heading clickable active" type="button"><span class="font-icon icon iconfont icon-folder" style=""></span><a href="/views/Books/Front-end/" class="nav-link active title" aria-label="前端秘密"><!---->前端秘密<!----></a><span class="arrow down"></span></button><ul class="sidebar-links"><li><section class="sidebar-group"><button class="sidebar-heading clickable" type="button"><span class="font-icon icon iconfont icon-repo" style=""></span><a href="/views/Books/Front-end/JustReact/" class="nav-link title" aria-label="《React 技术揭秘》"><!---->《React 技术揭秘》<!----></a><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable active" type="button"><span class="font-icon icon iconfont icon-repo" style=""></span><a href="/views/Books/Front-end/JustVue2/" class="nav-link active title" aria-label="《Vue2 技术揭秘》"><!---->《Vue2 技术揭秘》<!----></a><span class="arrow down"></span></button><ul class="sidebar-links"><li><section class="sidebar-group"><button class="sidebar-heading clickable" type="button"><!----><span class="title">准备工作</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable" type="button"><!----><span class="title">数据驱动</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable" type="button"><!----><span class="title">组件化</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable active" type="button"><!----><span class="title">深入响应式原理</span><span class="arrow down"></span></button><ul class="sidebar-links"><li><!--[--><a href="/views/Books/Front-end/JustVue2/reactive/" class="nav-link sidebar-link sidebar-page" aria-label="Introduction"><!---->Introduction<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/views/Books/Front-end/JustVue2/reactive/reactive-object.html" class="nav-link sidebar-link sidebar-page" aria-label="响应式对象"><!---->响应式对象<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/views/Books/Front-end/JustVue2/reactive/getters.html" class="nav-link sidebar-link sidebar-page" aria-label="依赖收集"><!---->依赖收集<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/views/Books/Front-end/JustVue2/reactive/setters.html" class="nav-link sidebar-link sidebar-page" aria-label="派发更新"><!---->派发更新<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/views/Books/Front-end/JustVue2/reactive/next-tick.html" class="nav-link sidebar-link sidebar-page" aria-label="nextTick"><!---->nextTick<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/views/Books/Front-end/JustVue2/reactive/questions.html" class="nav-link sidebar-link sidebar-page" aria-label="检测变化的注意事项"><!---->检测变化的注意事项<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-current="page" href="/views/Books/Front-end/JustVue2/reactive/computed-watcher.html" class="router-link-active router-link-exact-active nav-link active sidebar-link sidebar-page active" aria-label="计算属性 VS 侦听属性"><!---->计算属性 VS 侦听属性<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/views/Books/Front-end/JustVue2/reactive/computed-watcher.html#computed" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="computed"><!---->computed<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/views/Books/Front-end/JustVue2/reactive/computed-watcher.html#watch" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="watch"><!---->watch<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/views/Books/Front-end/JustVue2/reactive/computed-watcher.html#watcher-options" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Watcher options"><!---->Watcher options<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/views/Books/Front-end/JustVue2/reactive/computed-watcher.html#deep-watcher" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="deep watcher"><!---->deep watcher<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/views/Books/Front-end/JustVue2/reactive/computed-watcher.html#user-watcher" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="user watcher"><!---->user watcher<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/views/Books/Front-end/JustVue2/reactive/computed-watcher.html#computed-watcher" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="computed watcher"><!---->computed watcher<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/views/Books/Front-end/JustVue2/reactive/computed-watcher.html#sync-watcher" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="sync watcher"><!---->sync watcher<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/views/Books/Front-end/JustVue2/reactive/computed-watcher.html#总结" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="总结"><!---->总结<!----></a><ul class="sidebar-sub-headers"></ul></li></ul><!--]--></li><li><!--[--><a href="/views/Books/Front-end/JustVue2/reactive/component-update.html" class="nav-link sidebar-link sidebar-page" aria-label="组件更新"><!---->组件更新<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/views/Books/Front-end/JustVue2/reactive/props.html" class="nav-link sidebar-link sidebar-page" aria-label="Props (v2.6.11)"><!---->Props (v2.6.11)<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/views/Books/Front-end/JustVue2/reactive/summary.html" class="nav-link sidebar-link sidebar-page" aria-label="原理图"><!---->原理图<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable" type="button"><!----><span class="title">编译</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable" type="button"><!----><span class="title">扩展</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable" type="button"><!----><span class="title">Vue Router</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable" type="button"><!----><span class="title">Vuex</span><span class="arrow end"></span></button><!----></section></li></ul></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable" type="button"><span class="font-icon icon iconfont icon-repo" style=""></span><a href="/views/Books/Front-end/TypescriptMaster/" class="nav-link title" aria-label="《TypeScript Deep Dive》"><!---->《TypeScript Deep Dive》<!----></a><span class="arrow end"></span></button><!----></section></li></ul></section></li></ul><!--[--><!----><!--]--></aside><!--[--><main class="page" id="main-content"><!--[--><!----><!----><nav class="breadcrumb disable"></nav><div class="page-title"><h1><!---->计算属性 VS 侦听属性</h1><div class="page-info"><span class="page-author-info" aria-label="作者🖊" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="https://mpbug.gitee.io/player/" target="_blank" rel="noopener noreferrer">魔法时空宝库</a></span><span property="author" content="魔法时空宝库"></span></span><!----><!----><!----><span class="page-reading-time-info" aria-label="阅读时间⌛" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>大约 12 分钟</span><meta property="timeRequired" content="PT12M"></span><!----><!----></div><hr></div><div class="toc-place-holder"><aside id="toc"><!--[--><!----><!--]--><div class="toc-header">此页内容<button type="button" class="print-button" title="打印"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button></div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/views/Books/Front-end/JustVue2/reactive/computed-watcher.html#computed" class="router-link-active router-link-exact-active toc-link level2">computed</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/views/Books/Front-end/JustVue2/reactive/computed-watcher.html#watch" class="router-link-active router-link-exact-active toc-link level2">watch</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/views/Books/Front-end/JustVue2/reactive/computed-watcher.html#watcher-options" class="router-link-active router-link-exact-active toc-link level2">Watcher options</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/views/Books/Front-end/JustVue2/reactive/computed-watcher.html#deep-watcher" class="router-link-active router-link-exact-active toc-link level3">deep watcher</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/views/Books/Front-end/JustVue2/reactive/computed-watcher.html#user-watcher" class="router-link-active router-link-exact-active toc-link level3">user watcher</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/views/Books/Front-end/JustVue2/reactive/computed-watcher.html#computed-watcher" class="router-link-active router-link-exact-active toc-link level3">computed watcher</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/views/Books/Front-end/JustVue2/reactive/computed-watcher.html#sync-watcher" class="router-link-active router-link-exact-active toc-link level3">sync watcher</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/views/Books/Front-end/JustVue2/reactive/computed-watcher.html#总结" class="router-link-active router-link-exact-active toc-link level2">总结</a></li><!----><!--]--></ul><div class="toc-marker" style="top:-1.7rem;"></div></div><!--[--><!----><!--]--></aside></div><!----><div class="theme-hope-content"><h1 id="计算属性-vs-侦听属性" tabindex="-1"><a class="header-anchor" href="#计算属性-vs-侦听属性" aria-hidden="true">#</a> 计算属性 VS 侦听属性</h1><p>Vue 的组件对象支持了计算属性 <code>computed</code> 和侦听属性 <code>watch</code> 2 个选项，很多同学不了解什么时候该用 <code>computed</code> 什么时候该用 <code>watch</code>。先不回答这个问题，我们接下来从源码实现的角度来分析它们两者有什么区别。</p><h2 id="computed" tabindex="-1"><a class="header-anchor" href="#computed" aria-hidden="true">#</a> <code>computed</code></h2><p>计算属性的初始化是发生在 Vue 实例初始化阶段的 <code>initState</code> 函数中，执行了 <code>if (opts.computed) initComputed(vm, opts.computed)</code>，<code>initComputed</code> 的定义在 <code>src/core/instance/state.js</code> 中：</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> computedWatcherOptions <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">computed</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">initComputed</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">vm</span><span class="token operator">:</span> Component<span class="token punctuation">,</span> <span class="token literal-property property">computed</span><span class="token operator">:</span> Object</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// $flow-disable-line</span>
  <span class="token keyword">const</span> watchers <span class="token operator">=</span> vm<span class="token punctuation">.</span>_computedWatchers <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span>
  <span class="token comment">// computed properties are just getters during SSR</span>
  <span class="token keyword">const</span> isSSR <span class="token operator">=</span> <span class="token function">isServerRendering</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> key <span class="token keyword">in</span> computed<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> userDef <span class="token operator">=</span> computed<span class="token punctuation">[</span>key<span class="token punctuation">]</span>
    <span class="token keyword">const</span> getter <span class="token operator">=</span> <span class="token keyword">typeof</span> userDef <span class="token operator">===</span> <span class="token string">&#39;function&#39;</span> <span class="token operator">?</span> userDef <span class="token operator">:</span> userDef<span class="token punctuation">.</span>get
    <span class="token keyword">if</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">!==</span> <span class="token string">&#39;production&#39;</span> <span class="token operator">&amp;&amp;</span> getter <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">warn</span><span class="token punctuation">(</span>
        <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Getter is missing for computed property &quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>key<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot;.</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
        vm
      <span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>isSSR<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// create internal watcher for the computed property.</span>
      watchers<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Watcher</span><span class="token punctuation">(</span>
        vm<span class="token punctuation">,</span>
        getter <span class="token operator">||</span> noop<span class="token punctuation">,</span>
        noop<span class="token punctuation">,</span>
        computedWatcherOptions
      <span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// component-defined computed properties are already defined on the</span>
    <span class="token comment">// component prototype. We only need to define computed properties defined</span>
    <span class="token comment">// at instantiation here.</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>key <span class="token keyword">in</span> vm<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">defineComputed</span><span class="token punctuation">(</span>vm<span class="token punctuation">,</span> key<span class="token punctuation">,</span> userDef<span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">!==</span> <span class="token string">&#39;production&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>key <span class="token keyword">in</span> vm<span class="token punctuation">.</span>$data<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">warn</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">The computed property &quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>key<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot; is already defined in data.</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> vm<span class="token punctuation">)</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>vm<span class="token punctuation">.</span>$options<span class="token punctuation">.</span>props <span class="token operator">&amp;&amp;</span> key <span class="token keyword">in</span> vm<span class="token punctuation">.</span>$options<span class="token punctuation">.</span>props<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">warn</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">The computed property &quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>key<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot; is already defined as a prop.</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> vm<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>函数首先创建 <code>vm._computedWatchers</code> 为一个空对象，接着对 <code>computed</code> 对象做遍历，拿到计算属性的每一个 <code>userDef</code>，然后尝试获取这个 <code>userDef</code> 对应的 <code>getter</code> 函数，拿不到则在开发环境下报警告。接下来为每一个 <code>getter</code> 创建一个 <code>watcher</code>，这个 <code>watcher</code> 和渲染 <code>watcher</code> 有一点很大的不同，它是一个 <code>computed watcher</code>，因为 <code>const computedWatcherOptions = { computed: true }</code>。<code>computed watcher</code> 和普通 <code>watcher</code> 的差别我稍后会介绍。最后对判断如果 <code>key</code> 不是 <code>vm</code> 的属性，则调用 <code>defineComputed(vm, key, userDef)</code>，否则判断计算属性对于的 <code>key</code> 是否已经被 <code>data</code> 或者 <code>prop</code> 所占用，如果是的话则在开发环境报相应的警告。</p><p>那么接下来需要重点关注 <code>defineComputed</code> 的实现：</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">defineComputed</span> <span class="token punctuation">(</span>
  <span class="token parameter"><span class="token literal-property property">target</span><span class="token operator">:</span> any<span class="token punctuation">,</span>
  <span class="token literal-property property">key</span><span class="token operator">:</span> string<span class="token punctuation">,</span>
  <span class="token literal-property property">userDef</span><span class="token operator">:</span> Object <span class="token operator">|</span> Function</span>
<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> shouldCache <span class="token operator">=</span> <span class="token operator">!</span><span class="token function">isServerRendering</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> userDef <span class="token operator">===</span> <span class="token string">&#39;function&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    sharedPropertyDefinition<span class="token punctuation">.</span>get <span class="token operator">=</span> shouldCache
      <span class="token operator">?</span> <span class="token function">createComputedGetter</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span>
      <span class="token operator">:</span> userDef
    sharedPropertyDefinition<span class="token punctuation">.</span>set <span class="token operator">=</span> noop
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    sharedPropertyDefinition<span class="token punctuation">.</span>get <span class="token operator">=</span> userDef<span class="token punctuation">.</span>get
      <span class="token operator">?</span> shouldCache <span class="token operator">&amp;&amp;</span> userDef<span class="token punctuation">.</span>cache <span class="token operator">!==</span> <span class="token boolean">false</span>
        <span class="token operator">?</span> <span class="token function">createComputedGetter</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span>
        <span class="token operator">:</span> userDef<span class="token punctuation">.</span>get
      <span class="token operator">:</span> noop
    sharedPropertyDefinition<span class="token punctuation">.</span>set <span class="token operator">=</span> userDef<span class="token punctuation">.</span>set
      <span class="token operator">?</span> userDef<span class="token punctuation">.</span>set
      <span class="token operator">:</span> noop
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">!==</span> <span class="token string">&#39;production&#39;</span> <span class="token operator">&amp;&amp;</span>
      sharedPropertyDefinition<span class="token punctuation">.</span>set <span class="token operator">===</span> noop<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    sharedPropertyDefinition<span class="token punctuation">.</span><span class="token function-variable function">set</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">warn</span><span class="token punctuation">(</span>
        <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Computed property &quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>key<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot; was assigned to but it has no setter.</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
        <span class="token keyword">this</span>
      <span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> key<span class="token punctuation">,</span> sharedPropertyDefinition<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>这段逻辑很简单，其实就是利用 <code>Object.defineProperty</code> 给计算属性对应的 <code>key</code> 值添加 getter 和 setter，setter 通常是计算属性是一个对象，并且拥有 <code>set</code> 方法的时候才有，否则是一个空函数。在平时的开发场景中，计算属性有 setter 的情况比较少，我们重点关注一下 getter 部分，缓存的配置也先忽略，最终 getter 对应的是 <code>createComputedGetter(key)</code> 的返回值，来看一下它的定义：</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">createComputedGetter</span> <span class="token punctuation">(</span><span class="token parameter">key</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token function">computedGetter</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> watcher <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_computedWatchers <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_computedWatchers<span class="token punctuation">[</span>key<span class="token punctuation">]</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>watcher<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      watcher<span class="token punctuation">.</span><span class="token function">depend</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token keyword">return</span> watcher<span class="token punctuation">.</span><span class="token function">evaluate</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>createComputedGetter</code> 返回一个函数 <code>computedGetter</code>，它就是计算属性对应的 getter。</p><p>整个计算属性的初始化过程到此结束，我们知道计算属性是一个 <code>computed watcher</code>，它和普通的 <code>watcher</code> 有什么区别呢，为了更加直观，接下来来我们来通过一个例子来分析 <code>computed watcher</code> 的实现。</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">var</span> vm <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">firstName</span><span class="token operator">:</span> <span class="token string">&#39;Foo&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">lastName</span><span class="token operator">:</span> <span class="token string">&#39;Bar&#39;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">computed</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">fullName</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>firstName <span class="token operator">+</span> <span class="token string">&#39; &#39;</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>lastName
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>当初始化这个 <code>computed watcher</code> 实例的时候，构造函数部分逻辑稍有不同：</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token function">constructor</span> <span class="token punctuation">(</span>
  <span class="token parameter"><span class="token literal-property property">vm</span><span class="token operator">:</span> Component<span class="token punctuation">,</span>
  <span class="token literal-property property">expOrFn</span><span class="token operator">:</span> string <span class="token operator">|</span> Function<span class="token punctuation">,</span>
  <span class="token literal-property property">cb</span><span class="token operator">:</span> Function<span class="token punctuation">,</span>
  options<span class="token operator">?</span><span class="token operator">:</span> <span class="token operator">?</span>Object<span class="token punctuation">,</span>
  isRenderWatcher<span class="token operator">?</span><span class="token operator">:</span> boolean</span>
<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>computed<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token keyword">undefined</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>dep <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Dep</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>  
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>可以发现 <code>computed watcher</code> 会并不会立刻求值，同时持有一个 <code>dep</code> 实例。</p><p>然后当我们的 <code>render</code> 函数执行访问到 <code>this.fullName</code> 的时候，就触发了计算属性的 <code>getter</code>，它会拿到计算属性对应的 <code>watcher</code>，然后执行 <code>watcher.depend()</code>，来看一下它的定义：</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token doc-comment comment">/**
  * Depend on this watcher. Only for computed property watchers.
  */</span>
<span class="token function">depend</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>dep <span class="token operator">&amp;&amp;</span> Dep<span class="token punctuation">.</span>target<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>dep<span class="token punctuation">.</span><span class="token function">depend</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>注意，这时候的 <code>Dep.target</code> 是渲染 <code>watcher</code>，所以 <code>this.dep.depend()</code> 相当于渲染 <code>watcher</code> 订阅了这个 <code>computed watcher</code> 的变化。</p><p>然后再执行 <code>watcher.evaluate()</code> 去求值，来看一下它的定义：</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token doc-comment comment">/**
  * Evaluate and return the value of the watcher.
  * This only gets called for computed property watchers.
  */</span>
<span class="token function">evaluate</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>dirty<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>dirty <span class="token operator">=</span> <span class="token boolean">false</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>value
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>evaluate</code> 的逻辑非常简单，判断 <code>this.dirty</code>，如果为 <code>true</code> 则通过 <code>this.get()</code> 求值，然后把 <code>this.dirty</code> 设置为 false。在求值过程中，会执行 <code>value = this.getter.call(vm, vm)</code>，这实际上就是执行了计算属性定义的 <code>getter</code> 函数，在我们这个例子就是执行了 <code>return this.firstName + &#39; &#39; + this.lastName</code>。</p><p>这里需要特别注意的是，由于 <code>this.firstName</code> 和 <code>this.lastName</code> 都是响应式对象，这里会触发它们的 getter，根据我们之前的分析，它们会把自身持有的 <code>dep</code> 添加到当前正在计算的 <code>watcher</code> 中，这个时候 <code>Dep.target</code> 就是这个 <code>computed watcher</code>。</p><p>最后通过 <code>return this.value</code> 拿到计算属性对应的值。我们知道了计算属性的求值过程，那么接下来看一下它依赖的数据变化后的逻辑。</p><p>一旦我们对计算属性依赖的数据做修改，则会触发 setter 过程，通知所有订阅它变化的 <code>watcher</code> 更新，执行 <code>watcher.update()</code> 方法：</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">/* istanbul ignore else */</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>computed<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// A computed property watcher has two modes: lazy and activated.</span>
  <span class="token comment">// It initializes as lazy by default, and only becomes activated when</span>
  <span class="token comment">// it is depended on by at least one subscriber, which is typically</span>
  <span class="token comment">// another computed property or a component&#39;s render function.</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>dep<span class="token punctuation">.</span>subs<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// In lazy mode, we don&#39;t want to perform computations until necessary,</span>
    <span class="token comment">// so we simply mark the watcher as dirty. The actual computation is</span>
    <span class="token comment">// performed just-in-time in this.evaluate() when the computed property</span>
    <span class="token comment">// is accessed.</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>dirty <span class="token operator">=</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token comment">// In activated mode, we want to proactively perform the computation</span>
    <span class="token comment">// but only notify our subscribers when the value has indeed changed.</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getAndInvoke</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>dep<span class="token punctuation">.</span><span class="token function">notify</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>sync<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
  <span class="token function">queueWatcher</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>那么对于计算属性这样的 <code>computed watcher</code>，它实际上是有 2 种模式，lazy 和 active。如果 <code>this.dep.subs.length === 0</code> 成立，则说明没有人去订阅这个 <code>computed watcher</code> 的变化，仅仅把 <code>this.dirty = true</code>，只有当下次再访问这个计算属性的时候才会重新求值。在我们的场景下，渲染 <code>watcher</code> 订阅了这个 <code>computed watcher</code> 的变化，那么它会执行：</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getAndInvoke</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>dep<span class="token punctuation">.</span><span class="token function">notify</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token function">getAndInvoke</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">cb</span><span class="token operator">:</span> Function</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> value <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>
    value <span class="token operator">!==</span> <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">||</span>
    <span class="token comment">// Deep watchers and watchers on Object/Arrays should fire even</span>
    <span class="token comment">// when the value is the same, because the value may</span>
    <span class="token comment">// have mutated.</span>
    <span class="token function">isObject</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token operator">||</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>deep
  <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// set new value</span>
    <span class="token keyword">const</span> oldValue <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>value
    <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">=</span> value
    <span class="token keyword">this</span><span class="token punctuation">.</span>dirty <span class="token operator">=</span> <span class="token boolean">false</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>user<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token function">cb</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>vm<span class="token punctuation">,</span> value<span class="token punctuation">,</span> oldValue<span class="token punctuation">)</span>
      <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">handleError</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>vm<span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">callback for watcher &quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>expression<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot;</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token function">cb</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>vm<span class="token punctuation">,</span> value<span class="token punctuation">,</span> oldValue<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>getAndInvoke</code> 函数会重新计算，然后对比新旧值，如果变化了则执行回调函数，那么这里这个回调函数是 <code>this.dep.notify()</code>，在我们这个场景下就是触发了渲染 <code>watcher</code> 重新渲染。</p><p>通过以上的分析，我们知道计算属性本质上就是一个 <code>computed watcher</code>，也了解了它的创建过程和被访问触发 getter 以及依赖更新的过程，其实这是最新的计算属性的实现，之所以这么设计是因为 Vue 想确保不仅仅是计算属性依赖的值发生变化，而是当计算属性最终计算的值发生变化才会触发渲染 <code>watcher</code> 重新渲染，本质上是一种优化。</p><p>接下来我们来分析一下侦听属性 <code>watch</code> 是怎么实现的。</p><h2 id="watch" tabindex="-1"><a class="header-anchor" href="#watch" aria-hidden="true">#</a> watch</h2><p>侦听属性的初始化也是发生在 Vue 的实例初始化阶段的 <code>initState</code> 函数中，在 <code>computed</code> 初始化之后，执行了：</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">if</span> <span class="token punctuation">(</span>opts<span class="token punctuation">.</span>watch <span class="token operator">&amp;&amp;</span> opts<span class="token punctuation">.</span>watch <span class="token operator">!==</span> nativeWatch<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">initWatch</span><span class="token punctuation">(</span>vm<span class="token punctuation">,</span> opts<span class="token punctuation">.</span>watch<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>来看一下 <code>initWatch</code> 的实现，它的定义在 <code>src/core/instance/state.js</code> 中：</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">initWatch</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">vm</span><span class="token operator">:</span> Component<span class="token punctuation">,</span> <span class="token literal-property property">watch</span><span class="token operator">:</span> Object</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> key <span class="token keyword">in</span> watch<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> handler <span class="token operator">=</span> watch<span class="token punctuation">[</span>key<span class="token punctuation">]</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>handler<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> handler<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">createWatcher</span><span class="token punctuation">(</span>vm<span class="token punctuation">,</span> key<span class="token punctuation">,</span> handler<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token function">createWatcher</span><span class="token punctuation">(</span>vm<span class="token punctuation">,</span> key<span class="token punctuation">,</span> handler<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>这里就是对 <code>watch</code> 对象做遍历，拿到每一个 <code>handler</code>，因为 Vue 是支持 <code>watch</code> 的同一个 <code>key</code> 对应多个 <code>handler</code>，所以如果 <code>handler</code> 是一个数组，则遍历这个数组，调用 <code>createWatcher</code> 方法，否则直接调用 <code>createWatcher</code>：</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">createWatcher</span> <span class="token punctuation">(</span>
  <span class="token parameter"><span class="token literal-property property">vm</span><span class="token operator">:</span> Component<span class="token punctuation">,</span>
  <span class="token literal-property property">expOrFn</span><span class="token operator">:</span> string <span class="token operator">|</span> Function<span class="token punctuation">,</span>
  <span class="token literal-property property">handler</span><span class="token operator">:</span> any<span class="token punctuation">,</span>
  options<span class="token operator">?</span><span class="token operator">:</span> Object</span>
<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isPlainObject</span><span class="token punctuation">(</span>handler<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    options <span class="token operator">=</span> handler
    handler <span class="token operator">=</span> handler<span class="token punctuation">.</span>handler
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> handler <span class="token operator">===</span> <span class="token string">&#39;string&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    handler <span class="token operator">=</span> vm<span class="token punctuation">[</span>handler<span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> vm<span class="token punctuation">.</span><span class="token function">$watch</span><span class="token punctuation">(</span>expOrFn<span class="token punctuation">,</span> handler<span class="token punctuation">,</span> options<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>这里的逻辑也很简单，首先对 <code>hanlder</code> 的类型做判断，拿到它最终的回调函数，最后调用 <code>vm.$watch(keyOrFn, handler, options)</code> 函数，<code>$watch</code> 是 Vue 原型上的方法，它是在执行 <code>stateMixin</code> 的时候定义的：</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token class-name">Vue</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">$watch</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>
  <span class="token parameter"><span class="token literal-property property">expOrFn</span><span class="token operator">:</span> string <span class="token operator">|</span> Function<span class="token punctuation">,</span>
  <span class="token literal-property property">cb</span><span class="token operator">:</span> any<span class="token punctuation">,</span>
  options<span class="token operator">?</span><span class="token operator">:</span> Object</span>
<span class="token punctuation">)</span><span class="token operator">:</span> Function <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token literal-property property">vm</span><span class="token operator">:</span> Component <span class="token operator">=</span> <span class="token keyword">this</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isPlainObject</span><span class="token punctuation">(</span>cb<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">createWatcher</span><span class="token punctuation">(</span>vm<span class="token punctuation">,</span> expOrFn<span class="token punctuation">,</span> cb<span class="token punctuation">,</span> options<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  options <span class="token operator">=</span> options <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  options<span class="token punctuation">.</span>user <span class="token operator">=</span> <span class="token boolean">true</span>
  <span class="token keyword">const</span> watcher <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Watcher</span><span class="token punctuation">(</span>vm<span class="token punctuation">,</span> expOrFn<span class="token punctuation">,</span> cb<span class="token punctuation">,</span> options<span class="token punctuation">)</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>options<span class="token punctuation">.</span>immediate<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">cb</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>vm<span class="token punctuation">,</span> watcher<span class="token punctuation">.</span>value<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token function">unwatchFn</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    watcher<span class="token punctuation">.</span><span class="token function">teardown</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>也就是说，侦听属性 <code>watch</code> 最终会调用 <code>$watch</code> 方法，这个方法首先判断 <code>cb</code> 如果是一个对象，则调用 <code>createWatcher</code> 方法，这是因为 <code>$watch</code> 方法是用户可以直接调用的，它可以传递一个对象，也可以传递函数。接着执行 <code>const watcher = new Watcher(vm, expOrFn, cb, options)</code> 实例化了一个 <code>watcher</code>，这里需要注意一点这是一个 <code>user watcher</code>，因为 <code>options.user = true</code>。通过实例化 <code>watcher</code> 的方式，一旦我们 <code>watch</code> 的数据发送变化，它最终会执行 <code>watcher</code> 的 <code>run</code> 方法，执行回调函数 <code>cb</code>，并且如果我们设置了 <code>immediate</code> 为 true，则直接会执行回调函数 <code>cb</code>。最后返回了一个 <code>unwatchFn</code> 方法，它会调用 <code>teardown</code> 方法去移除这个 <code>watcher</code>。</p><p>所以本质上侦听属性也是基于 <code>Watcher</code> 实现的，它是一个 <code>user watcher</code>。其实 <code>Watcher</code> 支持了不同的类型，下面我们梳理一下它有哪些类型以及它们的作用。</p><h2 id="watcher-options" tabindex="-1"><a class="header-anchor" href="#watcher-options" aria-hidden="true">#</a> Watcher options</h2><p><code>Watcher</code> 的构造函数对 <code>options</code> 做的了处理，代码如下：</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">if</span> <span class="token punctuation">(</span>options<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>deep <span class="token operator">=</span> <span class="token operator">!</span><span class="token operator">!</span>options<span class="token punctuation">.</span>deep
  <span class="token keyword">this</span><span class="token punctuation">.</span>user <span class="token operator">=</span> <span class="token operator">!</span><span class="token operator">!</span>options<span class="token punctuation">.</span>user
  <span class="token keyword">this</span><span class="token punctuation">.</span>computed <span class="token operator">=</span> <span class="token operator">!</span><span class="token operator">!</span>options<span class="token punctuation">.</span>computed
  <span class="token keyword">this</span><span class="token punctuation">.</span>sync <span class="token operator">=</span> <span class="token operator">!</span><span class="token operator">!</span>options<span class="token punctuation">.</span>sync
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>deep <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>user <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>computed <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>sync <span class="token operator">=</span> <span class="token boolean">false</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>所以 <code>watcher</code> 总共有 4 种类型，我们来一一分析它们，看看不同的类型执行的逻辑有哪些差别。</p><h3 id="deep-watcher" tabindex="-1"><a class="header-anchor" href="#deep-watcher" aria-hidden="true">#</a> deep watcher</h3><p>通常，如果我们想对一下对象做深度观测的时候，需要设置这个属性为 true，考虑到这种情况：</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">var</span> vm <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">a</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">b</span><span class="token operator">:</span> <span class="token number">1</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">watch</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">a</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token function">handler</span><span class="token punctuation">(</span><span class="token parameter">newVal</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>newVal<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
vm<span class="token punctuation">.</span>a<span class="token punctuation">.</span>b <span class="token operator">=</span> <span class="token number">2</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>这个时候是不会 log 任何数据的，因为我们是 watch 了 <code>a</code> 对象，只触发了 <code>a</code> 的 getter，并没有触发 <code>a.b</code> 的 getter，所以并没有订阅它的变化，导致我们对 <code>vm.a.b = 2</code> 赋值的时候，虽然触发了 setter，但没有可通知的对象，所以也并不会触发 watch 的回调函数了。</p><p>而我们只需要对代码做稍稍修改，就可以观测到这个变化了</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token literal-property property">watch</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">a</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">deep</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token function">handler</span><span class="token punctuation">(</span><span class="token parameter">newVal</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>newVal<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>这样就创建了一个 <code>deep watcher</code> 了，在 <code>watcher </code> 执行 <code>get</code> 求值的过程中有一段逻辑：</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> value <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getter</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>vm<span class="token punctuation">,</span> vm<span class="token punctuation">)</span>
  <span class="token comment">// ...</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>deep<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">traverse</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在对 watch 的表达式或者函数求值后，会调用 <code>traverse</code> 函数，它的定义在 <code>src/core/observer/traverse.js</code> 中：</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> _Set <span class="token keyword">as</span> Set<span class="token punctuation">,</span> isObject <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;../util/index&#39;</span>
<span class="token keyword">import</span> type <span class="token punctuation">{</span> SimpleSet <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;../util/index&#39;</span>
<span class="token keyword">import</span> VNode <span class="token keyword">from</span> <span class="token string">&#39;../vdom/vnode&#39;</span>

<span class="token keyword">const</span> seenObjects <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token doc-comment comment">/**
 * Recursively traverse an object to evoke all converted
 * getters, so that every nested property inside the object
 * is collected as a &quot;deep&quot; dependency.
 */</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">traverse</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">val</span><span class="token operator">:</span> any</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">_traverse</span><span class="token punctuation">(</span>val<span class="token punctuation">,</span> seenObjects<span class="token punctuation">)</span>
  seenObjects<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">_traverse</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">val</span><span class="token operator">:</span> any<span class="token punctuation">,</span> <span class="token literal-property property">seen</span><span class="token operator">:</span> SimpleSet</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> i<span class="token punctuation">,</span> keys
  <span class="token keyword">const</span> isA <span class="token operator">=</span> Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">!</span>isA <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token function">isObject</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">||</span> Object<span class="token punctuation">.</span><span class="token function">isFrozen</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span> <span class="token operator">||</span> val <span class="token keyword">instanceof</span> <span class="token class-name">VNode</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>val<span class="token punctuation">.</span>__ob__<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> depId <span class="token operator">=</span> val<span class="token punctuation">.</span>__ob__<span class="token punctuation">.</span>dep<span class="token punctuation">.</span>id
    <span class="token keyword">if</span> <span class="token punctuation">(</span>seen<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span>depId<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span>
    <span class="token punctuation">}</span>
    seen<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>depId<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>isA<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    i <span class="token operator">=</span> val<span class="token punctuation">.</span>length
    <span class="token keyword">while</span> <span class="token punctuation">(</span>i<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token function">_traverse</span><span class="token punctuation">(</span>val<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> seen<span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    keys <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span>
    i <span class="token operator">=</span> keys<span class="token punctuation">.</span>length
    <span class="token keyword">while</span> <span class="token punctuation">(</span>i<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token function">_traverse</span><span class="token punctuation">(</span>val<span class="token punctuation">[</span>keys<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> seen<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>traverse</code> 的逻辑也很简单，它实际上就是对一个对象做深层递归遍历，因为遍历过程中就是对一个子对象的访问，会触发它们的 getter 过程，这样就可以收集到依赖，也就是订阅它们变化的 <code>watcher</code>，这个函数实现还有一个小的优化，遍历过程中会把子响应式对象通过它们的 <code>dep id</code> 记录到 <code>seenObjects</code>，避免以后重复访问。</p><p>那么在执行了 <code>traverse</code> 后，我们再对 watch 的对象内部任何一个值做修改，也会调用 <code>watcher</code> 的回调函数了。</p><p>对 <code>deep watcher</code> 的理解非常重要，今后工作中如果大家观测了一个复杂对象，并且会改变对象内部深层某个值的时候也希望触发回调，一定要设置 <code>deep</code> 为 true，但是因为设置了 <code>deep</code> 后会执行 <code>traverse</code> 函数，会有一定的性能开销，所以一定要根据应用场景权衡是否要开启这个配置。</p><h3 id="user-watcher" tabindex="-1"><a class="header-anchor" href="#user-watcher" aria-hidden="true">#</a> user watcher</h3><p>前面我们分析过，通过 <code>vm.$watch</code> 创建的 <code>watcher</code> 是一个 <code>user watcher</code>，其实它的功能很简单，在对 <code>watcher</code> 求值以及在执行回调函数的时候，会处理一下错误，如下：</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>user<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">handleError</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> vm<span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">getter for watcher &quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>expression<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot;</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> e
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token function">getAndInvoke</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>user<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">cb</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>vm<span class="token punctuation">,</span> value<span class="token punctuation">,</span> oldValue<span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">handleError</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>vm<span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">callback for watcher &quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>expression<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot;</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">cb</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>vm<span class="token punctuation">,</span> value<span class="token punctuation">,</span> oldValue<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>handleError</code> 在 Vue 中是一个错误捕获并且暴露给用户的一个利器。</p><h3 id="computed-watcher" tabindex="-1"><a class="header-anchor" href="#computed-watcher" aria-hidden="true">#</a> computed watcher</h3><p><code>computed watcher</code> 几乎就是为计算属性量身定制的，我们刚才已经对它做了详细的分析，这里不再赘述了。</p><h3 id="sync-watcher" tabindex="-1"><a class="header-anchor" href="#sync-watcher" aria-hidden="true">#</a> sync watcher</h3><p>在我们之前对 <code>setter</code> 的分析过程知道，当响应式数据发送变化后，触发了 <code>watcher.update()</code>，只是把这个 <code>watcher</code> 推送到一个队列中，在 <code>nextTick</code> 后才会真正执行 <code>watcher</code> 的回调函数。而一旦我们设置了 <code>sync</code>，就可以在当前 <code>Tick</code> 中同步执行 <code>watcher</code> 的回调函数。</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token function">update</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>computed<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>sync<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token function">queueWatcher</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>只有当我们需要 watch 的值的变化到执行 <code>watcher</code> 的回调函数是一个同步过程的时候才会去设置该属性为 true。</p><h2 id="总结" tabindex="-1"><a class="header-anchor" href="#总结" aria-hidden="true">#</a> 总结</h2><p>通过这一小节的分析我们对计算属性和侦听属性的实现有了深入的了解，计算属性本质上是 <code>computed watcher</code>，而侦听属性本质上是 <code>user watcher</code>。就应用场景而言，计算属性适合用在模板渲染中，某个值是依赖了其它的响应式对象甚至是计算属性计算而来；而侦听属性适用于观测某个值的变化去完成一段复杂的业务逻辑。</p><p>同时我们又了解了 <code>watcher</code> 的 4 个 <code>options</code>，通常我们会在创建 <code>user watcher</code> 的时候配置 <code>deep</code> 和 <code>sync</code>，可以根据不同的场景做相应的配置。</p></div><!----><footer class="page-meta"><div class="meta-item edit-link"><a href="https://gitee.com/mpbug/mpbug/edit/main/views/Books/Front-end/JustVue2/reactive/computed-watcher.md" rel="noopener noreferrer" target="_blank" aria-label="在 GitHub 上编辑此页" class="nav-link label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->在 GitHub 上编辑此页<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="meta-item git-info"><!----><!----></div></footer><nav class="page-nav"><a href="/views/Books/Front-end/JustVue2/reactive/questions.html" class="nav-link prev" aria-label="检测变化的注意事项"><div class="hint"><span class="arrow start"></span>上一页</div><div class="link"><!---->检测变化的注意事项</div></a><a href="/views/Books/Front-end/JustVue2/reactive/component-update.html" class="nav-link next" aria-label="组件更新"><div class="hint">下一页<span class="arrow end"></span></div><div class="link">组件更新<!----></div></a></nav><div class="giscus-wrapper input-top" id="comment" style="display:block;"><div class="loading-icon-wrapper" style="display:flex;align-items:center;justify-content:center;height:96px"><svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" preserveAspectRatio="xMidYMid" viewBox="25 25 50 50"><animateTransform attributeName="transform" type="rotate" dur="2s" keyTimes="0;1" repeatCount="indefinite" values="0;360"></animateTransform><circle cx="50" cy="50" r="20" fill="none" stroke="currentColor" stroke-width="4" stroke-linecap="round"><animate attributeName="stroke-dasharray" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="1,200;90,200;1,200"></animate><animate attributeName="stroke-dashoffset" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="0;-35px;-125px"></animate></circle></svg></div></div><!----><!--]--></main><!--]--><footer class="footer-wrapper"><div class="footer">收纳万物的时空葫芦、变幻万物的魔法葫芦</div><div class="copyright">Copyright © 2023 魔法时空宝库</div></footer></div><!--]--><!----><!----><!--]--></div>
    <script type="module" src="/assets/app-36439b21.js" defer></script>
  </body>
</html>
